---
title: "Client Main"
description: "Main client-side tablet management and NUI integration"
---

# TabletClient

`client/main.lua` is the main client-side module that handles tablet UI, animations, and NUI callbacks.

## Global Table

```lua
TabletClient = TabletClient or {}
```

## Core Functions

### TabletClient.Open

Open the tablet UI:

```lua
TabletClient.Open()
```

- Checks if player can open (not dead, not in vehicle if restricted)
- Starts tablet animation (if enabled)
- Shows NUI and enables cursor

### TabletClient.Close

Close the tablet UI:

```lua
TabletClient.Close()
```

- Stops tablet animation
- Hides NUI and disables cursor
- Resets hidden state

### TabletClient.Toggle

Toggle tablet visibility:

```lua
TabletClient.Toggle()
```

### TabletClient.IsOpen

Check if tablet is open:

```lua
local isOpen = TabletClient.IsOpen()
```

### TabletClient.CanOpen

Check if player can open tablet:

```lua
local canOpen = TabletClient.CanOpen()
```

Returns `false` if:
- Player is dead (and `AllowWhileDead = false`)
- Player is in vehicle (and `AllowInVehicle = false`)

---

## Visibility Control

For external resources that need to temporarily hide the tablet (e.g., during minigames):

### TabletClient.GetState

Get current tablet state:

```lua
local state = TabletClient.GetState()
-- Returns: 'closed', 'open', or 'hidden'
```

### TabletClient.Hide

Temporarily hide tablet without closing:

```lua
TabletClient.Hide(force)
```

- Hides NUI but keeps tablet "open" state
- Use for minigames, cutscenes, etc.

### TabletClient.Show

Restore hidden tablet:

```lua
TabletClient.Show()
```

- Only works if tablet is in 'hidden' state
- Restores NUI and focus

**Example Usage:**

```lua
-- In minigame resource
exports['dusa_tablet']:HideTablet()

-- Start minigame...

-- When minigame ends
exports['dusa_tablet']:ShowTablet()
```

---

## Notifications

### TabletClient.ShowNotification

Show a notification in the tablet UI:

```lua
TabletClient.ShowNotification(app, title, description, time)
```

**Parameters:**

| Parameter | Type | Default | Description |
|-----------|------|---------|-------------|
| `app` | string | `'System'` | App name shown in notification |
| `title` | string | `'Notification'` | Notification title |
| `description` | string | `''` | Notification body |
| `time` | string | `'now'` | Time string |

**Example:**

```lua
TabletClient.ShowNotification('Mail', 'New Email', 'You have 3 unread messages', 'Just now')
```

---

## Custom Apps API

### TabletClient.RegisterApp

Register a custom app:

```lua
TabletClient.RegisterApp({
    id = 'myapp',
    name = 'My App',
    icon = 'myapp.svg',
    ui = {
        type = 'iframe',
        url = 'https://myapp.example.com'
    },
    permissions = {
        job = 'police'
    },
    onOpen = function() end,  -- Lua callback (not sent to NUI)
    onClose = function() end  -- Lua callback (not sent to NUI)
})
```

**Returns:** `true` if registered, `false` if failed

### TabletClient.UnregisterApp

Remove a registered app:

```lua
TabletClient.UnregisterApp('myapp')
```

### TabletClient.SendCustomAppMessage

Send message to a custom app's NUI:

```lua
TabletClient.SendCustomAppMessage('myapp', 'action', { data = value })
```

### TabletClient.GetRegisteredApps

Get all registered custom apps:

```lua
local apps = TabletClient.GetRegisteredApps()
```

---

## Animation System

When `Config.Tablet.Animation.Enabled = true`:

```lua
-- Animation loads automatically
-- Prop attaches to player hand
-- Animation plays while tablet is open
```

**Configuration:**

```lua
Config.Tablet.Animation = {
    Enabled = true,
    Dict = 'amb@world_human_seat_wall_tablet@female@base',
    Anim = 'base',
    Prop = 'prop_cs_tablet',
    Bone = 28422,  -- Hand bone
    Offset = { x = 0.0, y = 0.0, z = 0.0 },
    Rotation = { x = 0.0, y = 0.0, z = 0.0 },
    Flags = 49
}
```

---

## NUI Callbacks

### Core Callbacks

| Callback | Description |
|----------|-------------|
| `closeTablet` | Close tablet from NUI |
| `ready` | NUI ready, send initial data |
| `debug:log` | Receive log from NUI |
| `tablet:setLocale` | Change language |
| `tablet:showNotification` | Show notification |
| `tablet:getStreetName` | Get street name from coords |

### App-Specific Callbacks

All app callbacks forward to server via `lib.callback.await`:

```lua
RegisterNUICallback('tablet:mail:send', function(data, cb)
    local result = lib.callback.await('tablet:mail:send', false, data)
    cb(result or { success = false, error = 'No response' })
end)
```

---

## Exports

```lua
-- Core
exports('Open', TabletClient.Open)
exports('Close', TabletClient.Close)
exports('Toggle', TabletClient.Toggle)
exports('IsOpen', TabletClient.IsOpen)

-- Custom Apps
exports('RegisterApp', TabletClient.RegisterApp)
exports('UnregisterApp', TabletClient.UnregisterApp)
exports('SendCustomAppMessage', TabletClient.SendCustomAppMessage)
exports('GetRegisteredApps', TabletClient.GetRegisteredApps)

-- Notifications
exports('ShowNotification', TabletClient.ShowNotification)

-- Visibility Control
exports('HideTablet', TabletClient.Hide)
exports('ShowTablet', TabletClient.Show)
exports('GetTabletState', TabletClient.GetState)

-- Language
exports('GetCurrentLocale', function()
    return TabletLocale.getLocale() or Config.General.Locale
end)
```

---

## Events

### dusa_tablet:openFromItem

Open tablet when item is used:

```lua
RegisterNetEvent('dusa_tablet:openFromItem', function()
    if not isTabletOpen then
        TabletClient.Open()
    end
end)
```

---

## Death/State Monitoring

The client monitors for state changes that should close the tablet:

```lua
CreateThread(function()
    while true do
        Wait(500)
        if isTabletOpen then
            if Framework.IsPlayerDead() then
                TabletClient.Close()
                lib.notify({
                    title = 'Tablet',
                    description = TabletLocale.t('notifications.closedDueToDeath'),
                    type = 'error'
                })
            end
        end
    end
end)
```
